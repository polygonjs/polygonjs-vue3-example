import{b as O,c as T}from"./chunk-4NZTGWFT.js";import"./chunk-KBNISIIW.js";var M=(s=>(s.EXPORT_MANIFEST="scene/export_manifest.json",s.CODE_PREFIX="scene/code",s.PROPERTIES="scene/code/properties.json",s.EDITOR="scene/editor.json",s.ASSETS="scene/assets.json",s.POLYGONJS="js/all.js",s.SCENE_DATA_LOADER="js/sceneDataLoader.js",s.POLY_CONFIG="js/polyConfig.js",s.JS_FILES="scene/js_files.json",s.POSTER="images/poster.png",s))(M||{});var S=class{static async importSceneData(e){e.editorMode==null&&(e.editorMode=!1);let n=e.manifest,r=e.urlPrefix||M.CODE_PREFIX,c=Object.keys(n.nodes),a=[];for(let o of c){let l=n.nodes[o],t=`${r}/root/${o}.json?t=${l}`;a.push(t)}let u=`${r}/root.json?t=${n.root}`,d=`${r}/properties.json?t=${n.properties}`,p=[u,d];if(e.editorMode){let o=Date.now();p.push(`${r}/ui.json?t=${o}`)}for(let o of a)p.push(o);let f=0,y=p.length,h=o=>{let l=T.sceneData,t=l.start+l.mult*o;e.onProgress&&e.onProgress(t),O.dispatchProgressEvent(t,e.sceneName)},E=p.map(async o=>{let l=await fetch(o);return f++,h(f/y),l}),R=await Promise.all(E),i=[];for(let o of R)i.push(await o.json());let P={root:i[0],properties:i[1]},g=2;e.editorMode&&(P.ui=i[2],g+=1);let _={},m=Object.keys(n.nodes);for(let o=0;o<m.length;o++){let l=m[o],t=i[o+g];_[l]=t}return this.assemble(P,m,_)}static async assemble(e,n,r){let c={root:e.root,properties:e.properties,ui:e.ui};for(let a=0;a<n.length;a++){let u=n[a],d=r[u];this.insert_child_data(c.root,u,d)}return c}static insert_child_data(e,n,r){let c=n.split("/");if(c.length==1)e.nodes||(e.nodes={}),e.nodes[n]=r;else{let a=c.shift(),u=c.join("/"),d=e.nodes[a];this.insert_child_data(d,u,r)}}};var x="1650557705089",w="1650557705089",L={perspectiveCamera1:"1650557705089","perspectiveCamera1/events1":"1650557705089",floor:"1650557705089",COP:"1650557705089",geo2:"1650557705089","geo2/MAT":"1650557705089",rhino:"1650557705089","rhino/MAT":"1650557705089","rhino/MAT/meshPhysicalBuilder1":"1650557705089","rhino/MAT/meshLambertBuilder_INSTANCES":"1650557705089","rhino/MAT/meshPhysicalBuilder_INSTANCES":"1650557705089"},A={properties:x,root:w,nodes:L};var D=async s=>{let e=s.sceneDataRoot||"./polygonjs/scenes";return await S.importSceneData({sceneName:"scene_02",urlPrefix:e+"/scene_02",manifest:A,onProgress:s.onProgress})};var Y=async function(s){let{onProgress:e,domElement:n,configureSceneData:r,autoPlay:c,sceneDataRoot:a,assetsRoot:u,libsRootPrefix:d,printWarnings:p}=s,f=s.runRegister!=null?s.runRegister:!0,h=(s.loadModules!=null?s.loadModules:!0)?["EXRLoader","GLTFLoader"]:[],E=h.map(t=>import("./modules/"+t+(s.moduleImportSuffix||""))),R=[import("./loadSceneFromSceneData-7NKSWPCF.js"),D({onProgress:e,sceneDataRoot:a}),...E],i=await Promise.all(R),{Poly:P,loadSceneFromSceneData_scene_02:g}=i[0],_=i[1];r&&r(_);let m=[];for(let t=2;t<i.length;t++)m.push(i[t]);let o=0;for(let t of h){let I=t+"Module";P.registerModule(m[o][I]),o++}return await g({onProgress:e,sceneData:_,domElement:n,runRegister:f,autoPlay:c,assetsRoot:u,libsRootPrefix:d,printWarnings:p})};export{Y as loadSceneAndMountAsync_scene_02};
