import{$b as Mr,Fa as Nr,Ka as Fr,Lb as Rr,cc as Or,dc as Dr,ec as Zr,ga as Kn,na as $e,qa as Tr,xb as qn,ya as Dn,za as xn}from"../chunk-WDUCRR75.js";import{b as qt}from"../chunk-KBNISIIW.js";var $n=class extends Or{constructor(e){super(e)}load(e,t,o,s){let f=this,l=new Mr,p=new Zr(this.manager);return p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setPath(this.path),p.setWithCredentials(f.withCredentials),p.load(e,function(w){let c=f.parse(w);!c||(c.image!==void 0?l.image=c.image:c.data!==void 0&&(l.image.width=c.width,l.image.height=c.height,l.image.data=c.data),l.wrapS=c.wrapS!==void 0?c.wrapS:Kn,l.wrapT=c.wrapT!==void 0?c.wrapT:Kn,l.magFilter=c.magFilter!==void 0?c.magFilter:$e,l.minFilter=c.minFilter!==void 0?c.minFilter:$e,l.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.encoding!==void 0&&(l.encoding=c.encoding),c.flipY!==void 0&&(l.flipY=c.flipY),c.format!==void 0&&(l.format=c.format),c.type!==void 0&&(l.type=c.type),c.mipmaps!==void 0&&(l.mipmaps=c.mipmaps,l.minFilter=Tr),c.mipmapCount===1&&(l.minFilter=$e),c.generateMipmaps!==void 0&&(l.generateMipmaps=c.generateMipmaps),l.needsUpdate=!0,t&&t(l,c))},o,s),l}};var Zn=class{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Rr(e,-65504,65504),_r[0]=e;let t=kr[0],o=t>>23&511;return _e[o]+((t&8388607)>>ke[o])}static fromHalfFloat(e){let t=e>>10;return kr[0]=Jn[dr[t]+(e&1023)]+je[t],_r[0]}},Br=new ArrayBuffer(4),_r=new Float32Array(Br),kr=new Uint32Array(Br),_e=new Uint32Array(512),ke=new Uint32Array(512);for(let n=0;n<256;++n){let e=n-127;e<-27?(_e[n]=0,_e[n|256]=32768,ke[n]=24,ke[n|256]=24):e<-14?(_e[n]=1024>>-e-14,_e[n|256]=1024>>-e-14|32768,ke[n]=-e-1,ke[n|256]=-e-1):e<=15?(_e[n]=e+15<<10,_e[n|256]=e+15<<10|32768,ke[n]=13,ke[n|256]=13):e<128?(_e[n]=31744,_e[n|256]=64512,ke[n]=24,ke[n|256]=24):(_e[n]=31744,_e[n|256]=64512,ke[n]=13,ke[n|256]=13)}var Jn=new Uint32Array(2048),je=new Uint32Array(64),dr=new Uint32Array(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,Jn[n]=e|t}for(let n=1024;n<2048;++n)Jn[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)je[n]=n<<23;je[31]=1199570944;je[32]=2147483648;for(let n=33;n<63;++n)je[n]=2147483648+(n-32<<23);je[63]=3347054592;for(let n=1;n<64;++n)n!==32&&(dr[n]=1024);var Xn={};qt(Xn,{AsyncCompress:()=>Qt,AsyncDecompress:()=>ni,AsyncDeflate:()=>st,AsyncGunzip:()=>ut,AsyncGzip:()=>Qt,AsyncInflate:()=>wr,AsyncUnzipInflate:()=>hi,AsyncUnzlib:()=>ft,AsyncZipDeflate:()=>si,AsyncZlib:()=>jt,Compress:()=>rr,DecodeUTF8:()=>ii,Decompress:()=>pt,Deflate:()=>Le,EncodeUTF8:()=>oi,Gunzip:()=>Pn,Gzip:()=>rr,Inflate:()=>Ce,Unzip:()=>pi,UnzipInflate:()=>fi,UnzipPassThrough:()=>St,Unzlib:()=>Gn,Zip:()=>li,ZipDeflate:()=>ai,ZipPassThrough:()=>Un,Zlib:()=>ir,compress:()=>Vt,compressSync:()=>tr,decompress:()=>ri,decompressSync:()=>ti,deflate:()=>lt,deflateSync:()=>Tn,gunzip:()=>ct,gunzipSync:()=>bn,gzip:()=>Vt,gzipSync:()=>tr,inflate:()=>gr,inflateSync:()=>hn,strFromU8:()=>yr,strToU8:()=>Ke,unzip:()=>vi,unzipSync:()=>wi,unzlib:()=>ht,unzlibSync:()=>Ye,zip:()=>ui,zipSync:()=>ci,zlib:()=>ei,zlibSync:()=>or});var Lr={},Vn=function(n){return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))},br=function(n){return new Worker(n)};try{URL.revokeObjectURL(Vn(""))}catch{Vn=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},br=function(e){return new Worker(e,{type:"module"})}}var $t=function(n,e,t,o,s){var f=br(Lr[e]||(Lr[e]=Vn(n)));return f.onerror=function(l){return s(l.error,null)},f.onmessage=function(l){return s(null,l.data)},f.postMessage(t,o),f},H=Uint8Array,ye=Uint16Array,Ge=Uint32Array,on=new H([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),an=new H([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),En=new H([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gr=function(n,e){for(var t=new ye(31),o=0;o<31;++o)t[o]=e+=1<<n[o-1];for(var s=new Ge(t[30]),o=1;o<30;++o)for(var f=t[o];f<t[o+1];++f)s[f]=f-t[o]<<5|o;return[t,s]},Xr=Gr(on,2),sr=Xr[0],Ln=Xr[1];sr[28]=258,Ln[258]=28;var Yr=Gr(an,0),Wr=Yr[0],jn=Yr[1],In=new ye(32768);for($=0;$<32768;++$)Pe=($&43690)>>>1|($&21845)<<1,Pe=(Pe&52428)>>>2|(Pe&13107)<<2,Pe=(Pe&61680)>>>4|(Pe&3855)<<4,In[$]=((Pe&65280)>>>8|(Pe&255)<<8)>>>1;var Pe,$,Oe=function(n,e,t){for(var o=n.length,s=0,f=new ye(e);s<o;++s)++f[n[s]-1];var l=new ye(e);for(s=0;s<e;++s)l[s]=l[s-1]+f[s-1]<<1;var p;if(t){p=new ye(1<<e);var w=15-e;for(s=0;s<o;++s)if(n[s])for(var c=s<<4|n[s],g=e-n[s],I=l[n[s]-1]++<<g,F=I|(1<<g)-1;I<=F;++I)p[In[I]>>>w]=c}else for(p=new ye(o),s=0;s<o;++s)n[s]&&(p[s]=In[l[n[s]-1]++]>>>15-n[s]);return p},Xe=new H(288);for($=0;$<144;++$)Xe[$]=8;var $;for($=144;$<256;++$)Xe[$]=9;var $;for($=256;$<280;++$)Xe[$]=7;var $;for($=280;$<288;++$)Xe[$]=8;var $,rn=new H(32);for($=0;$<32;++$)rn[$]=5;var $,Kr=Oe(Xe,9,0),qr=Oe(Xe,9,1),$r=Oe(rn,5,0),Jr=Oe(rn,5,1),kn=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},Me=function(n,e,t){var o=e/8|0;return(n[o]|n[o+1]<<8)>>(e&7)&t},Bn=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},An=function(n){return(n/8|0)+(n&7&&1)},De=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var o=new(n instanceof ye?ye:n instanceof Ge?Ge:H)(t-e);return o.set(n.subarray(e,t)),o},Cn=function(n,e,t){var o=n.length;if(!o||t&&!t.l&&o<5)return e||new H(0);var s=!e||t,f=!t||t.i;t||(t={}),e||(e=new H(o*3));var l=function(j){var Ne=e.length;if(j>Ne){var ze=new H(Math.max(Ne*2,j));ze.set(e),e=ze}},p=t.f||0,w=t.p||0,c=t.b||0,g=t.l,I=t.d,F=t.m,_=t.n,R=o*8;do{if(!g){t.f=p=Me(n,w,1);var M=Me(n,w+1,3);if(w+=3,M)if(M==1)g=qr,I=Jr,F=9,_=5;else if(M==2){var Z=Me(n,w,31)+257,b=Me(n,w+10,15)+4,J=Z+Me(n,w+5,31)+1;w+=14;for(var Y=new H(J),d=new H(19),z=0;z<b;++z)d[En[z]]=Me(n,w+z*3,7);w+=b*3;for(var se=kn(d),V=(1<<se)-1,Ee=Oe(d,se,1),z=0;z<J;){var W=Ee[Me(n,w,V)];w+=W&15;var O=W>>>4;if(O<16)Y[z++]=O;else{var q=0,G=0;for(O==16?(G=3+Me(n,w,3),w+=2,q=Y[z-1]):O==17?(G=3+Me(n,w,7),w+=3):O==18&&(G=11+Me(n,w,127),w+=7);G--;)Y[z++]=q}}var oe=Y.subarray(0,Z),ne=Y.subarray(Z);F=kn(oe),_=kn(ne),g=Oe(oe,F,1),I=Oe(ne,_,1)}else throw"invalid block type";else{var O=An(w)+4,X=n[O-4]|n[O-3]<<8,B=O+X;if(B>o){if(f)throw"unexpected EOF";break}s&&l(c+X),e.set(n.subarray(O,B),c),t.b=c+=X,t.p=w=B*8;continue}if(w>R){if(f)throw"unexpected EOF";break}}s&&l(c+131072);for(var te=(1<<F)-1,we=(1<<_)-1,xe=w;;xe=w){var q=g[Bn(n,w)&te],le=q>>>4;if(w+=q&15,w>R){if(f)throw"unexpected EOF";break}if(!q)throw"invalid length/literal";if(le<256)e[c++]=le;else if(le==256){xe=w,g=null;break}else{var he=le-254;if(le>264){var z=le-257,fe=on[z];he=Me(n,w,(1<<fe)-1)+sr[z],w+=fe}var Ue=I[Bn(n,w)&we],ge=Ue>>>4;if(!Ue)throw"invalid distance";w+=Ue&15;var ne=Wr[ge];if(ge>3){var fe=an[ge];ne+=Bn(n,w)&(1<<fe)-1,w+=fe}if(w>R){if(f)throw"unexpected EOF";break}s&&l(c+131072);for(var pe=c+he;c<pe;c+=4)e[c]=e[c-ne],e[c+1]=e[c+1-ne],e[c+2]=e[c+2-ne],e[c+3]=e[c+3-ne];c=pe}}t.l=g,t.p=xe,t.b=c,g&&(p=1,t.m=F,t.d=I,t.n=_)}while(!p);return c==e.length?e:De(e,0,c)},de=function(n,e,t){t<<=e&7;var o=e/8|0;n[o]|=t,n[o+1]|=t>>>8},en=function(n,e,t){t<<=e&7;var o=e/8|0;n[o]|=t,n[o+1]|=t>>>8,n[o+2]|=t>>>16},dn=function(n,e){for(var t=[],o=0;o<n.length;++o)n[o]&&t.push({s:o,f:n[o]});var s=t.length,f=t.slice();if(!s)return[be,0];if(s==1){var l=new H(t[0].s+1);return l[t[0].s]=1,[l,1]}t.sort(function(J,Y){return J.f-Y.f}),t.push({s:-1,f:25001});var p=t[0],w=t[1],c=0,g=1,I=2;for(t[0]={s:-1,f:p.f+w.f,l:p,r:w};g!=s-1;)p=t[t[c].f<t[I].f?c++:I++],w=t[c!=g&&t[c].f<t[I].f?c++:I++],t[g++]={s:-1,f:p.f+w.f,l:p,r:w};for(var F=f[0].s,o=1;o<s;++o)f[o].s>F&&(F=f[o].s);var _=new ye(F+1),R=Hn(t[g-1],_,0);if(R>e){var o=0,M=0,O=R-e,X=1<<O;for(f.sort(function(Y,d){return _[d.s]-_[Y.s]||Y.f-d.f});o<s;++o){var B=f[o].s;if(_[B]>e)M+=X-(1<<R-_[B]),_[B]=e;else break}for(M>>>=O;M>0;){var Z=f[o].s;_[Z]<e?M-=1<<e-_[Z]++-1:++o}for(;o>=0&&M;--o){var b=f[o].s;_[b]==e&&(--_[b],++M)}R=e}return[new H(_),R]},Hn=function(n,e,t){return n.s==-1?Math.max(Hn(n.l,e,t+1),Hn(n.r,e,t+1)):e[n.s]=t},er=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new ye(++e),o=0,s=n[0],f=1,l=function(w){t[o++]=w},p=1;p<=e;++p)if(n[p]==s&&p!=e)++f;else{if(!s&&f>2){for(;f>138;f-=138)l(32754);f>2&&(l(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(l(s),--f;f>6;f-=6)l(8304);f>2&&(l(f-3<<5|8208),f=0)}for(;f--;)l(s);f=1,s=n[p]}return[t.subarray(0,o),e]},nn=function(n,e){for(var t=0,o=0;o<e.length;++o)t+=n[o]*e[o];return t},Sn=function(n,e,t){var o=t.length,s=An(e+2);n[s]=o&255,n[s+1]=o>>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var f=0;f<o;++f)n[s+f+4]=t[f];return(s+4+o)*8},nr=function(n,e,t,o,s,f,l,p,w,c,g){de(e,g++,t),++s[256];for(var I=dn(s,15),F=I[0],_=I[1],R=dn(f,15),M=R[0],O=R[1],X=er(F),B=X[0],Z=X[1],b=er(M),J=b[0],Y=b[1],d=new ye(19),z=0;z<B.length;++z)d[B[z]&31]++;for(var z=0;z<J.length;++z)d[J[z]&31]++;for(var se=dn(d,7),V=se[0],Ee=se[1],W=19;W>4&&!V[En[W-1]];--W);var q=c+5<<3,G=nn(s,Xe)+nn(f,rn)+l,oe=nn(s,F)+nn(f,M)+l+14+3*W+nn(d,V)+(2*d[16]+3*d[17]+7*d[18]);if(q<=G&&q<=oe)return Sn(e,g,n.subarray(w,w+c));var ne,te,we,xe;if(de(e,g,1+(oe<G)),g+=2,oe<G){ne=Oe(F,_,0),te=F,we=Oe(M,O,0),xe=M;var le=Oe(V,Ee,0);de(e,g,Z-257),de(e,g+5,Y-1),de(e,g+10,W-4),g+=14;for(var z=0;z<W;++z)de(e,g+3*z,V[En[z]]);g+=3*W;for(var he=[B,J],fe=0;fe<2;++fe)for(var Ue=he[fe],z=0;z<Ue.length;++z){var ge=Ue[z]&31;de(e,g,le[ge]),g+=V[ge],ge>15&&(de(e,g,Ue[z]>>>5&127),g+=Ue[z]>>>12)}}else ne=Kr,te=Xe,we=$r,xe=rn;for(var z=0;z<p;++z)if(o[z]>255){var ge=o[z]>>>18&31;en(e,g,ne[ge+257]),g+=te[ge+257],ge>7&&(de(e,g,o[z]>>>23&31),g+=on[ge]);var pe=o[z]&31;en(e,g,we[pe]),g+=xe[pe],pe>3&&(en(e,g,o[z]>>>5&8191),g+=an[pe])}else en(e,g,ne[o[z]]),g+=te[o[z]];return en(e,g,ne[256]),g+te[256]},Qr=new Ge([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),be=new H(0),Vr=function(n,e,t,o,s,f){var l=n.length,p=new H(o+l+5*(1+Math.ceil(l/7e3))+s),w=p.subarray(o,p.length-s),c=0;if(!e||l<8)for(var g=0;g<=l;g+=65535){var I=g+65535;I<l?c=Sn(w,c,n.subarray(g,I)):(w[g]=f,c=Sn(w,c,n.subarray(g,l)))}else{for(var F=Qr[e-1],_=F>>>13,R=F&8191,M=(1<<t)-1,O=new ye(32768),X=new ye(M+1),B=Math.ceil(t/3),Z=2*B,b=function(Qe){return(n[Qe]^n[Qe+1]<<B^n[Qe+2]<<Z)&M},J=new Ge(25e3),Y=new ye(288),d=new ye(32),z=0,se=0,g=0,V=0,Ee=0,W=0;g<l;++g){var q=b(g),G=g&32767,oe=X[q];if(O[G]=oe,X[q]=G,Ee<=g){var ne=l-g;if((z>7e3||V>24576)&&ne>423){c=nr(n,w,0,J,Y,d,se,V,W,g-W,c),V=z=se=0,W=g;for(var te=0;te<286;++te)Y[te]=0;for(var te=0;te<30;++te)d[te]=0}var we=2,xe=0,le=R,he=G-oe&32767;if(ne>2&&q==b(g-he))for(var fe=Math.min(_,ne)-1,Ue=Math.min(32767,g),ge=Math.min(258,ne);he<=Ue&&--le&&G!=oe;){if(n[g+we]==n[g+we-he]){for(var pe=0;pe<ge&&n[g+pe]==n[g+pe-he];++pe);if(pe>we){if(we=pe,xe=he,pe>fe)break;for(var j=Math.min(he,pe-2),Ne=0,te=0;te<j;++te){var ze=g-he+te+32768&32767,Yn=O[ze],Nn=ze-Yn+32768&32767;Nn>Ne&&(Ne=Nn,oe=ze)}}}G=oe,oe=O[G],he+=G-oe+32768&32767}if(xe){J[V++]=268435456|Ln[we]<<18|jn[xe];var pn=Ln[we]&31,Fn=jn[xe]&31;se+=on[pn]+an[Fn],++Y[257+pn],++d[Fn],Ee=g+we,++z}else J[V++]=n[g],++Y[n[g]]}}c=nr(n,w,f,J,Y,d,se,V,W,g-W,c),!f&&c&7&&(c=Sn(w,c+1,be))}return De(p,0,o+An(c)+s)},jr=function(){for(var n=new Ge(256),e=0;e<256;++e){for(var t=e,o=9;--o;)t=(t&1&&3988292384)^t>>>1;n[e]=t}return n}(),sn=function(){var n=-1;return{p:function(e){for(var t=n,o=0;o<e.length;++o)t=jr[t&255^e[o]]^t>>>8;n=t},d:function(){return~n}}},lr=function(){var n=1,e=0;return{p:function(t){for(var o=n,s=e,f=t.length,l=0;l!=f;){for(var p=Math.min(l+2655,f);l<p;++l)s+=o+=t[l];o=(o&65535)+15*(o>>16),s=(s&65535)+15*(s>>16)}n=o,e=s},d:function(){return n%=65521,e%=65521,(n&255)<<24|n>>>8<<16|(e&255)<<8|e>>>8}}},Je=function(n,e,t,o,s){return Vr(n,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):12+e.mem,t,o,!s)},zn=function(n,e){var t={};for(var o in n)t[o]=n[o];for(var o in e)t[o]=e[o];return t},Hr=function(n,e,t){for(var o=n(),s=n.toString(),f=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/ /g,"").split(","),l=0;l<o.length;++l){var p=o[l],w=f[l];if(typeof p=="function"){e+=";"+w+"=";var c=p.toString();if(p.prototype)if(c.indexOf("[native code]")!=-1){var g=c.indexOf(" ",8)+1;e+=c.slice(g,c.indexOf("(",g))}else{e+=c;for(var I in p.prototype)e+=";"+w+".prototype."+I+"="+p.prototype[I].toString()}else e+=c}else t[w]=p}return[e,t]},_n=[],Jt=function(n){var e=[];for(var t in n)(n[t]instanceof H||n[t]instanceof ye||n[t]instanceof Ge)&&e.push((n[t]=new n[t].constructor(n[t])).buffer);return e},et=function(n,e,t,o){var s;if(!_n[t]){for(var f="",l={},p=n.length-1,w=0;w<p;++w)s=Hr(n[w],f,l),f=s[0],l=s[1];_n[t]=Hr(n[p],f,l)}var c=zn({},_n[t][1]);return $t(_n[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,c,Jt(c),o)},ln=function(){return[H,ye,Ge,on,an,En,sr,Wr,qr,Jr,In,Oe,kn,Me,Bn,An,De,Cn,hn,qe,ur]},un=function(){return[H,ye,Ge,on,an,En,Ln,jn,Kr,Xe,$r,rn,In,Qr,be,Oe,de,en,dn,Hn,er,nn,Sn,nr,An,De,Vr,Je,Tn,qe]},nt=function(){return[cr,hr,Q,sn,jr]},rt=function(){return[fr,ot]},tt=function(){return[pr,Q,lr]},it=function(){return[at]},qe=function(n){return postMessage(n,[n.buffer])},ur=function(n){return n&&n.size&&new H(n.size)},cn=function(n,e,t,o,s,f){var l=et(t,o,s,function(p,w){l.terminate(),f(p,w)});return l.postMessage([n,e],e.consume?[n.buffer]:[]),function(){l.terminate()}},Ze=function(n){return n.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return n.push(e.data[0],e.data[1])}},fn=function(n,e,t,o,s){var f,l=et(n,o,s,function(p,w){p?(l.terminate(),e.ondata.call(e,p)):(w[1]&&l.terminate(),e.ondata.call(e,p,w[0],w[1]))});l.postMessage(t),e.push=function(p,w){if(f)throw"stream finished";if(!e.ondata)throw"no stream handler";l.postMessage([p,f=w],[p.buffer])},e.terminate=function(){l.terminate()}},Ie=function(n,e){return n[e]|n[e+1]<<8},ce=function(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0},Qn=function(n,e){return ce(n,e)+ce(n,e+4)*4294967296},Q=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},cr=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:e.level==9?2:0,n[9]=3,e.mtime!=0&&Q(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var o=0;o<=t.length;++o)n[o+10]=t.charCodeAt(o)}},fr=function(n){if(n[0]!=31||n[1]!=139||n[2]!=8)throw"invalid gzip data";var e=n[3],t=10;e&4&&(t+=n[10]|(n[11]<<8)+2);for(var o=(e>>3&1)+(e>>4&1);o>0;o-=!n[t++]);return t+(e&2)},ot=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},hr=function(n){return 10+(n.filename&&n.filename.length+1||0)},pr=function(n,e){var t=e.level,o=t==0?0:t<6?1:t==9?3:2;n[0]=120,n[1]=o<<6|(o?32-2*o:1)},at=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function vr(n,e){return!e&&typeof n=="function"&&(e=n,n={}),this.ondata=e,n}var Le=function(){function n(e,t){!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,this.o=e||{}}return n.prototype.p=function(e,t){this.ondata(Je(e,this.o,0,0,!t),t)},n.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},n}();var st=function(){function n(e,t){fn([un,function(){return[Ze,Le]}],this,vr.call(this,e,t),function(o){var s=new Le(o.data);onmessage=Ze(s)},6)}return n}();function lt(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[un],function(o){return qe(Tn(o.data[0],o.data[1]))},0,t)}function Tn(n,e){return Je(n,e||{},0,0)}var Ce=function(){function n(e){this.s={},this.p=new H(0),this.ondata=e}return n.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,o=new H(t+e.length);o.set(this.p),o.set(e,t),this.p=o},n.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,o=Cn(this.p,this.o,this.s);this.ondata(De(o,t,this.s.b),this.d),this.o=De(o,this.s.b-32768),this.s.b=this.o.length,this.p=De(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,t){this.e(e),this.c(t)},n}();var wr=function(){function n(e){this.ondata=e,fn([ln,function(){return[Ze,Ce]}],this,0,function(){var t=new Ce;onmessage=Ze(t)},7)}return n}();function gr(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[ln],function(o){return qe(hn(o.data[0],ur(o.data[1])))},1,t)}function hn(n,e){return Cn(n,e)}var rr=function(){function n(e,t){this.c=sn(),this.l=0,this.v=1,Le.call(this,e,t)}return n.prototype.push=function(e,t){Le.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var o=Je(e,this.o,this.v&&hr(this.o),t&&8,!t);this.v&&(cr(o,this.o),this.v=0),t&&(Q(o,o.length-8,this.c.d()),Q(o,o.length-4,this.l)),this.ondata(o,t)},n}();var Qt=function(){function n(e,t){fn([un,nt,function(){return[Ze,Le,rr]}],this,vr.call(this,e,t),function(o){var s=new rr(o.data);onmessage=Ze(s)},8)}return n}();function Vt(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[un,nt,function(){return[tr]}],function(o){return qe(tr(o.data[0],o.data[1]))},2,t)}function tr(n,e){e||(e={});var t=sn(),o=n.length;t.p(n);var s=Je(n,e,hr(e),8),f=s.length;return cr(s,e),Q(s,f-8,t.d()),Q(s,f-4,o),s}var Pn=function(){function n(e){this.v=1,Ce.call(this,e)}return n.prototype.push=function(e,t){if(Ce.prototype.e.call(this,e),this.v){var o=this.p.length>3?fr(this.p):4;if(o>=this.p.length&&!t)return;this.p=this.p.subarray(o),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Ce.prototype.c.call(this,t)},n}();var ut=function(){function n(e){this.ondata=e,fn([ln,rt,function(){return[Ze,Ce,Pn]}],this,0,function(){var t=new Pn;onmessage=Ze(t)},9)}return n}();function ct(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[ln,rt,function(){return[bn]}],function(o){return qe(bn(o.data[0]))},3,t)}function bn(n,e){return Cn(n.subarray(fr(n),-8),e||new H(ot(n)))}var ir=function(){function n(e,t){this.c=lr(),this.v=1,Le.call(this,e,t)}return n.prototype.push=function(e,t){Le.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e);var o=Je(e,this.o,this.v&&2,t&&4,!t);this.v&&(pr(o,this.o),this.v=0),t&&Q(o,o.length-4,this.c.d()),this.ondata(o,t)},n}();var jt=function(){function n(e,t){fn([un,tt,function(){return[Ze,Le,ir]}],this,vr.call(this,e,t),function(o){var s=new ir(o.data);onmessage=Ze(s)},10)}return n}();function ei(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[un,tt,function(){return[or]}],function(o){return qe(or(o.data[0],o.data[1]))},4,t)}function or(n,e){e||(e={});var t=lr();t.p(n);var o=Je(n,e,2,4);return pr(o,e),Q(o,o.length-4,t.d()),o}var Gn=function(){function n(e){this.v=1,Ce.call(this,e)}return n.prototype.push=function(e,t){if(Ce.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Ce.prototype.c.call(this,t)},n}();var ft=function(){function n(e){this.ondata=e,fn([ln,it,function(){return[Ze,Ce,Gn]}],this,0,function(){var t=new Gn;onmessage=Ze(t)},11)}return n}();function ht(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return cn(n,e,[ln,it,function(){return[Ye]}],function(o){return qe(Ye(o.data[0],ur(o.data[1])))},5,t)}function Ye(n,e){return Cn((at(n),n.subarray(2,-4)),e)}var pt=function(){function n(e){this.G=Pn,this.I=Ce,this.Z=Gn,this.ondata=e}return n.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var o=new H(this.p.length+e.length);o.set(this.p),o.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var s=this,f=function(){s.ondata.apply(s,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(f):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(f):new this.Z(f),this.s.push(this.p,t),this.p=null}}},n}();var ni=function(){function n(e){this.G=ut,this.I=wr,this.Z=ft,this.ondata=e}return n.prototype.push=function(e,t){pt.prototype.push.call(this,e,t)},n}();function ri(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";return n[0]==31&&n[1]==139&&n[2]==8?ct(n,e,t):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?gr(n,e,t):ht(n,e,t)}function ti(n,e){return n[0]==31&&n[1]==139&&n[2]==8?bn(n,e):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?hn(n,e):Ye(n,e)}var mr=function(n,e,t,o){for(var s in n){var f=n[s],l=e+s;f instanceof H?t[l]=[f,o]:Array.isArray(f)?t[l]=[f[0],zn(o,f[1])]:mr(f,l+"/",t,o)}},Pr=typeof TextEncoder<"u"&&new TextEncoder,ar=typeof TextDecoder<"u"&&new TextDecoder,vt=0;try{ar.decode(be,{stream:!0}),vt=1}catch{}var wt=function(n){for(var e="",t=0;;){var o=n[t++],s=(o>127)+(o>223)+(o>239);if(t+s>n.length)return[e,De(n,t-1)];s?s==3?(o=((o&15)<<18|(n[t++]&63)<<12|(n[t++]&63)<<6|n[t++]&63)-65536,e+=String.fromCharCode(55296|o>>10,56320|o&1023)):s&1?e+=String.fromCharCode((o&31)<<6|n[t++]&63):e+=String.fromCharCode((o&15)<<12|(n[t++]&63)<<6|n[t++]&63):e+=String.fromCharCode(o)}},ii=function(){function n(e){this.ondata=e,vt?this.t=new TextDecoder:this.p=be}return n.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}return}if(!this.p)throw"stream finished";var o=new H(this.p.length+e.length);o.set(this.p),o.set(e,this.p.length);var s=wt(o),f=s[0],l=s[1];if(t){if(l.length)throw"invalid utf-8 data";this.p=null}else this.p=l;this.ondata(f,t)},n}();var oi=function(){function n(e){this.ondata=e}return n.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Ke(e),this.d=t||!1)},n}();function Ke(n,e){if(e){for(var t=new H(n.length),o=0;o<n.length;++o)t[o]=n.charCodeAt(o);return t}if(Pr)return Pr.encode(n);for(var s=n.length,f=new H(n.length+(n.length>>1)),l=0,p=function(g){f[l++]=g},o=0;o<s;++o){if(l+5>f.length){var w=new H(l+8+(s-o<<1));w.set(f),f=w}var c=n.charCodeAt(o);c<128||e?p(c):c<2048?(p(192|c>>6),p(128|c&63)):c>55295&&c<57344?(c=65536+(c&1023<<10)|n.charCodeAt(++o)&1023,p(240|c>>18),p(128|c>>12&63),p(128|c>>6&63),p(128|c&63)):(p(224|c>>12),p(128|c>>6&63),p(128|c&63))}return De(f,0,l)}function yr(n,e){if(e){for(var t="",o=0;o<n.length;o+=16384)t+=String.fromCharCode.apply(null,n.subarray(o,o+16384));return t}else{if(ar)return ar.decode(n);var s=wt(n),f=s[0],l=s[1];if(l.length)throw"invalid utf-8 data";return f}}var gt=function(n){return n==1?3:n<6?2:n==9?1:0},mt=function(n,e){return e+30+Ie(n,e+26)+Ie(n,e+28)},yt=function(n,e,t){var o=Ie(n,e+28),s=yr(n.subarray(e+46,e+46+o),!(Ie(n,e+8)&2048)),f=e+46+o,l=ce(n,e+20),p=t&&l==4294967295?xt(n,f):[l,ce(n,e+24),ce(n,e+42)],w=p[0],c=p[1],g=p[2];return[Ie(n,e+10),w,c,s,f+Ie(n,e+30)+Ie(n,e+32),g]},xt=function(n,e){for(;Ie(n,e)!=1;e+=4+Ie(n,e+2));return[Qn(n,e+12),Qn(n,e+4),Qn(n,e+20)]},We=function(n){var e=0;if(n)for(var t in n){var o=n[t].length;if(o>65535)throw"extra field too long";e+=o+4}return e},tn=function(n,e,t,o,s,f,l,p){var w=o.length,c=t.extra,g=p&&p.length,I=We(c);Q(n,e,l!=null?33639248:67324752),e+=4,l!=null&&(n[e++]=20,n[e++]=t.os),n[e]=20,e+=2,n[e++]=t.flag<<1|(f==null&&8),n[e++]=s&&8,n[e++]=t.compression&255,n[e++]=t.compression>>8;var F=new Date(t.mtime==null?Date.now():t.mtime),_=F.getFullYear()-1980;if(_<0||_>119)throw"date not in range 1980-2099";if(Q(n,e,_<<25|F.getMonth()+1<<21|F.getDate()<<16|F.getHours()<<11|F.getMinutes()<<5|F.getSeconds()>>>1),e+=4,f!=null&&(Q(n,e,t.crc),Q(n,e+4,f),Q(n,e+8,t.size)),Q(n,e+12,w),Q(n,e+14,I),e+=16,l!=null&&(Q(n,e,g),Q(n,e+6,t.attrs),Q(n,e+10,l),e+=14),n.set(o,e),e+=w,I)for(var R in c){var M=c[R],O=M.length;Q(n,e,+R),Q(n,e+2,O),n.set(M,e+4),e+=4+O}return g&&(n.set(p,e),e+=g),e},xr=function(n,e,t,o,s){Q(n,e,101010256),Q(n,e+8,t),Q(n,e+10,t),Q(n,e+12,o),Q(n,e+16,s)},Un=function(){function n(e){this.filename=e,this.c=sn(),this.size=0,this.compression=0}return n.prototype.process=function(e,t){this.ondata(null,e,t)},n.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},n}();var ai=function(){function n(e,t){var o=this;t||(t={}),Un.call(this,e),this.d=new Le(t,function(s,f){o.ondata(null,s,f)}),this.compression=8,this.flag=gt(t.level)}return n.prototype.process=function(e,t){try{this.d.push(e,t)}catch(o){this.ondata(o,null,t)}},n.prototype.push=function(e,t){Un.prototype.push.call(this,e,t)},n}();var si=function(){function n(e,t){var o=this;t||(t={}),Un.call(this,e),this.d=new st(t,function(s,f,l){o.ondata(s,f,l)}),this.compression=8,this.flag=gt(t.level),this.terminate=this.d.terminate}return n.prototype.process=function(e,t){this.d.push(e,t)},n.prototype.push=function(e,t){Un.prototype.push.call(this,e,t)},n}();var li=function(){function n(e){this.ondata=e,this.u=[],this.d=1}return n.prototype.add=function(e){var t=this;if(this.d&2)throw"stream finished";var o=Ke(e.filename),s=o.length,f=e.comment,l=f&&Ke(f),p=s!=e.filename.length||l&&f.length!=l.length,w=s+We(e.extra)+30;if(s>65535)throw"filename too long";var c=new H(w);tn(c,0,e,o,p);var g=[c],I=function(){for(var O=0,X=g;O<X.length;O++){var B=X[O];t.ondata(null,B,!1)}g=[]},F=this.d;this.d=0;var _=this.u.length,R=zn(e,{f:o,u:p,o:l,t:function(){e.terminate&&e.terminate()},r:function(){if(I(),F){var O=t.u[_+1];O?O.r():t.d=1}F=1}}),M=0;e.ondata=function(O,X,B){if(O)t.ondata(O,X,B),t.terminate();else if(M+=X.length,g.push(X),B){var Z=new H(16);Q(Z,0,134695760),Q(Z,4,e.crc),Q(Z,8,M),Q(Z,12,e.size),g.push(Z),R.c=M,R.b=w+M+16,R.crc=e.crc,R.size=e.size,F&&R.r(),F=1}else F&&I()},this.u.push(R)},n.prototype.end=function(){var e=this;if(this.d&2)throw this.d&1?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){!(e.d&1)||(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},n.prototype.e=function(){for(var e=0,t=0,o=0,s=0,f=this.u;s<f.length;s++){var l=f[s];o+=46+l.f.length+We(l.extra)+(l.o?l.o.length:0)}for(var p=new H(o+22),w=0,c=this.u;w<c.length;w++){var l=c[w];tn(p,e,l,l.f,l.u,l.c,t,l.o),e+=46+l.f.length+We(l.extra)+(l.o?l.o.length:0),t+=l.b}xr(p,e,this.u.length,o,t),this.ondata(null,p,!0),this.d=2},n.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var o=t[e];o.t()}this.d=2},n}();function ui(n,e,t){if(t||(t=e,e={}),typeof t!="function")throw"no callback";var o={};mr(n,"",o,e);var s=Object.keys(o),f=s.length,l=0,p=0,w=f,c=new Array(f),g=[],I=function(){for(var M=0;M<g.length;++M)g[M]()},F=function(){var M=new H(p+22),O=l,X=p-l;p=0;for(var B=0;B<w;++B){var Z=c[B];try{var b=Z.c.length;tn(M,p,Z,Z.f,Z.u,b);var J=30+Z.f.length+We(Z.extra),Y=p+J;M.set(Z.c,Y),tn(M,l,Z,Z.f,Z.u,b,p,Z.m),l+=16+J+(Z.m?Z.m.length:0),p=Y+b}catch(d){return t(d,null)}}xr(M,l,c.length,X,O),t(null,M)};f||F();for(var _=function(M){var O=s[M],X=o[O],B=X[0],Z=X[1],b=sn(),J=B.length;b.p(B);var Y=Ke(O),d=Y.length,z=Z.comment,se=z&&Ke(z),V=se&&se.length,Ee=We(Z.extra),W=Z.level==0?0:8,q=function(G,oe){if(G)I(),t(G,null);else{var ne=oe.length;c[M]=zn(Z,{size:J,crc:b.d(),c:oe,f:Y,m:se,u:d!=O.length||se&&z.length!=V,compression:W}),l+=30+d+Ee+ne,p+=76+2*(d+Ee)+(V||0)+ne,--f||F()}};if(d>65535&&q("filename too long",null),!W)q(null,B);else if(J<16e4)try{q(null,Tn(B,Z))}catch(G){q(G,null)}else g.push(lt(B,Z,q))},R=0;R<w;++R)_(R);return I}function ci(n,e){e||(e={});var t={},o=[];mr(n,"",t,e);var s=0,f=0;for(var l in t){var p=t[l],w=p[0],c=p[1],g=c.level==0?0:8,I=Ke(l),F=I.length,_=c.comment,R=_&&Ke(_),M=R&&R.length,O=We(c.extra);if(F>65535)throw"filename too long";var X=g?Tn(w,c):w,B=X.length,Z=sn();Z.p(w),o.push(zn(c,{size:w.length,crc:Z.d(),c:X,f:I,m:R,u:F!=l.length||R&&_.length!=M,o:s,compression:g})),s+=30+F+O+B,f+=76+2*(F+O)+(M||0)+B}for(var b=new H(f+22),J=s,Y=f-s,d=0;d<o.length;++d){var I=o[d];tn(b,I.o,I,I.f,I.u,I.c.length);var z=30+I.f.length+We(I.extra);b.set(I.c,I.o+z),tn(b,s,I,I.f,I.u,I.c.length,I.o,I.m),s+=16+z+(I.m?I.m.length:0)}return xr(b,s,o.length,Y,J),b}var St=function(){function n(){}return n.prototype.push=function(e,t){this.ondata(null,e,t)},n.compression=0,n}();var fi=function(){function n(){var e=this;this.i=new Ce(function(t,o){e.ondata(null,t,o)})}return n.prototype.push=function(e,t){try{this.i.push(e,t)}catch(o){this.ondata(o,e,t)}},n.compression=8,n}();var hi=function(){function n(e,t){var o=this;t<32e4?this.i=new Ce(function(s,f){o.ondata(null,s,f)}):(this.i=new wr(function(s,f,l){o.ondata(s,f,l)}),this.terminate=this.i.terminate)}return n.prototype.push=function(e,t){this.i.terminate&&(e=De(e,0)),this.i.push(e,t)},n.compression=8,n}();var pi=function(){function n(e){this.onfile=e,this.k=[],this.o={0:St},this.p=be}return n.prototype.push=function(e,t){var o=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var s=Math.min(this.c,e.length),f=e.subarray(0,s);if(this.c-=s,this.d?this.d.push(f,!this.c):this.k[0].push(f),e=e.subarray(s),e.length)return this.push(e,t)}else{var l=0,p=0,w=void 0,c=void 0;this.p.length?e.length?(c=new H(this.p.length+e.length),c.set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var g=c.length,I=this.c,F=I&&this.d,_=function(){var X,B=ce(c,p);if(B==67324752){l=1,w=p,R.d=null,R.c=0;var Z=Ie(c,p+6),b=Ie(c,p+8),J=Z&2048,Y=Z&8,d=Ie(c,p+26),z=Ie(c,p+28);if(g>p+30+d+z){var se=[];R.k.unshift(se),l=2;var V=ce(c,p+18),Ee=ce(c,p+22),W=yr(c.subarray(p+30,p+=30+d),!J);V==4294967295?(X=Y?[-2]:xt(c,p),V=X[0],Ee=X[1]):Y&&(V=-1),p+=z,R.c=V;var q,G={name:W,compression:b,start:function(){if(!G.ondata)throw"no callback";if(!V)G.ondata(null,be,!0);else{var oe=o.o[b];if(!oe)throw"unknown compression type "+b;q=V<0?new oe(W):new oe(W,V,Ee),q.ondata=function(xe,le,he){G.ondata(xe,le,he)};for(var ne=0,te=se;ne<te.length;ne++){var we=te[ne];q.push(we,!1)}o.k[0]==se&&o.c?o.d=q:q.push(be,!0)}},terminate:function(){q&&q.terminate&&q.terminate()}};V>=0&&(G.size=V,G.originalSize=Ee),R.onfile(G)}return"break"}else if(I){if(B==134695760)return w=p+=12+(I==-2&&8),l=3,R.c=0,"break";if(B==33639248)return w=p-=4,l=3,R.c=0,"break"}},R=this;p<g-4;++p){var M=_();if(M==="break")break}if(this.p=be,I<0){var O=l?c.subarray(0,w-12-(I==-2&&8)-(ce(c,w-16)==134695760&&4)):c.subarray(0,p);F?F.push(O,!!l):this.k[+(l==2)].push(O)}if(l&2)return this.push(c.subarray(p),t);this.p=c.subarray(p)}if(t){if(this.c)throw"invalid zip file";this.p=null}},n.prototype.register=function(e){this.o[e.compression]=e},n}();function vi(n,e){if(typeof e!="function")throw"no callback";for(var t=[],o=function(){for(var F=0;F<t.length;++F)t[F]()},s={},f=n.length-22;ce(n,f)!=101010256;--f)if(!f||n.length-f>65558){e("invalid zip file",null);return}var l=Ie(n,f+8);l||e(null,{});var p=l,w=ce(n,f+16),c=w==4294967295;if(c){if(f=ce(n,f-12),ce(n,f)!=101075792){e("invalid zip file",null);return}p=l=ce(n,f+32),w=ce(n,f+48)}for(var g=function(F){var _=yt(n,w,c),R=_[0],M=_[1],O=_[2],X=_[3],B=_[4],Z=_[5],b=mt(n,Z);w=B;var J=function(d,z){d?(o(),e(d,null)):(s[X]=z,--l||e(null,s))};if(!R)J(null,De(n,b,b+M));else if(R==8){var Y=n.subarray(b,b+M);if(M<32e4)try{J(null,hn(Y,new H(O)))}catch(d){J(d,null)}else t.push(gr(Y,{size:O},J))}else J("unknown compression type "+R,null)},I=0;I<p;++I)g(I);return o}function wi(n){for(var e={},t=n.length-22;ce(n,t)!=101010256;--t)if(!t||n.length-t>65558)throw"invalid zip file";var o=Ie(n,t+8);if(!o)return{};var s=ce(n,t+16),f=s==4294967295;if(f){if(t=ce(n,t-12),ce(n,t)!=101075792)throw"invalid zip file";o=ce(n,t+32),s=ce(n,t+48)}for(var l=0;l<o;++l){var p=yt(n,s,f),w=p[0],c=p[1],g=p[2],I=p[3],F=p[4],_=p[5],R=mt(n,_);if(s=F,!w)e[I]=De(n,R,R+c);else if(w==8)e[I]=hn(n.subarray(R,R+c),new H(g));else throw"unknown compression type "+w}return e}var Sr=class extends $n{constructor(e){super(e);this.type=xn}parse(e){let se=Math.pow(2.7182818,2.2);function V(r,i){let a=0;for(let v=0;v<65536;++v)(v==0||r[v>>3]&1<<(v&7))&&(i[a++]=v);let u=a-1;for(;a<65536;)i[a++]=0;return u}function Ee(r){for(let i=0;i<16384;i++)r[i]={},r[i].len=0,r[i].lit=0,r[i].p=null}let W={l:0,c:0,lc:0};function q(r,i,a,u,v){for(;a<r;)i=i<<8|Cr(u,v),a+=8;a-=r,W.l=i>>a&(1<<r)-1,W.c=i,W.lc=a}let G=new Array(59);function oe(r){for(let a=0;a<=58;++a)G[a]=0;for(let a=0;a<65537;++a)G[r[a]]+=1;let i=0;for(let a=58;a>0;--a){let u=i+G[a]>>1;G[a]=i,i=u}for(let a=0;a<65537;++a){let u=r[a];u>0&&(r[a]=u|G[u]++<<6)}}function ne(r,i,a,u,v,h){let y=i,S=0,E=0;for(;u<=v;u++){if(y.value-i.value>a)return!1;q(6,S,E,r,y);let m=W.l;if(S=W.c,E=W.lc,h[u]=m,m==63){if(y.value-i.value>a)throw new Error("Something wrong with hufUnpackEncTable");q(8,S,E,r,y);let x=W.l+6;if(S=W.c,E=W.lc,u+x>v+1)throw new Error("Something wrong with hufUnpackEncTable");for(;x--;)h[u++]=0;u--}else if(m>=59){let x=m-59+2;if(u+x>v+1)throw new Error("Something wrong with hufUnpackEncTable");for(;x--;)h[u++]=0;u--}}oe(h)}function te(r){return r&63}function we(r){return r>>6}function xe(r,i,a,u){for(;i<=a;i++){let v=we(r[i]),h=te(r[i]);if(v>>h)throw new Error("Invalid table entry");if(h>14){let y=u[v>>h-14];if(y.len)throw new Error("Invalid table entry");if(y.lit++,y.p){let S=y.p;y.p=new Array(y.lit);for(let E=0;E<y.lit-1;++E)y.p[E]=S[E]}else y.p=new Array(1);y.p[y.lit-1]=i}else if(h){let y=0;for(let S=1<<14-h;S>0;S--){let E=u[(v<<14-h)+y];if(E.len||E.p)throw new Error("Invalid table entry");E.len=h,E.lit=i,y++}}}return!0}let le={c:0,lc:0};function he(r,i,a,u){r=r<<8|Cr(a,u),i+=8,le.c=r,le.lc=i}let fe={c:0,lc:0};function Ue(r,i,a,u,v,h,y,S,E){if(r==i){u<8&&(he(a,u,v,h),a=le.c,u=le.lc),u-=8;let m=a>>u;if(m=new Uint8Array([m])[0],S.value+m>E)return!1;let x=y[S.value-1];for(;m-- >0;)y[S.value++]=x}else if(S.value<E)y[S.value++]=r;else return!1;fe.c=a,fe.lc=u}function ge(r){return r&65535}function pe(r){let i=ge(r);return i>32767?i-65536:i}let j={a:0,b:0};function Ne(r,i){let a=pe(r),v=pe(i),h=a+(v&1)+(v>>1),y=h,S=h-v;j.a=y,j.b=S}function ze(r,i){let a=ge(r),u=ge(i),v=a-(u>>1)&65535,h=u+v-32768&65535;j.a=h,j.b=v}function Yn(r,i,a,u,v,h,y){let S=y<16384,E=a>v?v:a,m=1,x,A;for(;m<=E;)m<<=1;for(m>>=1,x=m,m>>=1;m>=1;){A=0;let C=A+h*(v-x),D=h*m,k=h*x,T=u*m,N=u*x,L,ae,ue,Te;for(;A<=C;A+=k){let ie=A,K=A+u*(a-x);for(;ie<=K;ie+=N){let ve=ie+T,Re=ie+D,me=Re+T;S?(Ne(r[ie+i],r[Re+i]),L=j.a,ue=j.b,Ne(r[ve+i],r[me+i]),ae=j.a,Te=j.b,Ne(L,ae),r[ie+i]=j.a,r[ve+i]=j.b,Ne(ue,Te),r[Re+i]=j.a,r[me+i]=j.b):(ze(r[ie+i],r[Re+i]),L=j.a,ue=j.b,ze(r[ve+i],r[me+i]),ae=j.a,Te=j.b,ze(L,ae),r[ie+i]=j.a,r[ve+i]=j.b,ze(ue,Te),r[Re+i]=j.a,r[me+i]=j.b)}if(a&m){let ve=ie+D;S?Ne(r[ie+i],r[ve+i]):ze(r[ie+i],r[ve+i]),L=j.a,r[ve+i]=j.b,r[ie+i]=L}}if(v&m){let ie=A,K=A+u*(a-x);for(;ie<=K;ie+=N){let ve=ie+T;S?Ne(r[ie+i],r[ve+i]):ze(r[ie+i],r[ve+i]),L=j.a,r[ve+i]=j.b,r[ie+i]=L}}x=m,m>>=1}return A}function Nn(r,i,a,u,v,h,y,S,E){let m=0,x=0,A=y,C=Math.trunc(u.value+(v+7)/8);for(;u.value<C;)for(he(m,x,a,u),m=le.c,x=le.lc;x>=14;){let k=m>>x-14&16383,T=i[k];if(T.len)x-=T.len,Ue(T.lit,h,m,x,a,u,S,E,A),m=fe.c,x=fe.lc;else{if(!T.p)throw new Error("hufDecode issues");let N;for(N=0;N<T.lit;N++){let L=te(r[T.p[N]]);for(;x<L&&u.value<C;)he(m,x,a,u),m=le.c,x=le.lc;if(x>=L&&we(r[T.p[N]])==(m>>x-L&(1<<L)-1)){x-=L,Ue(T.p[N],h,m,x,a,u,S,E,A),m=fe.c,x=fe.lc;break}}if(N==T.lit)throw new Error("hufDecode issues")}}let D=8-v&7;for(m>>=D,x-=D;x>0;){let k=i[m<<14-x&16383];if(k.len)x-=k.len,Ue(k.lit,h,m,x,a,u,S,E,A),m=fe.c,x=fe.lc;else throw new Error("hufDecode issues")}return!0}function pn(r,i,a,u,v,h){let y={value:0},S=a.value,E=Ae(i,a),m=Ae(i,a);a.value+=4;let x=Ae(i,a);if(a.value+=4,E<0||E>=65537||m<0||m>=65537)throw new Error("Something wrong with HUF_ENCSIZE");let A=new Array(65537),C=new Array(16384);Ee(C);let D=u-(a.value-S);if(ne(r,a,D,E,m,A),x>8*(u-(a.value-S)))throw new Error("Something wrong with hufUncompress");xe(A,E,m,C),Nn(A,C,r,a,x,m,h,v,y)}function Fn(r,i,a){for(let u=0;u<a;++u)i[u]=r[i[u]]}function Er(r){for(let i=1;i<r.length;i++){let a=r[i-1]+r[i]-128;r[i]=a}}function Qe(r,i){let a=0,u=Math.floor((r.length+1)/2),v=0,h=r.length-1;for(;!(v>h||(i[v++]=r[a++],v>h));)i[v++]=r[u++]}function Ir(r){let i=r.byteLength,a=new Array,u=0,v=new DataView(r);for(;i>0;){let h=v.getInt8(u++);if(h<0){let y=-h;i-=y+1;for(let S=0;S<y;S++)a.push(v.getUint8(u++))}else{let y=h;i-=2;let S=v.getUint8(u++);for(let E=0;E<y+1;E++)a.push(S)}}return a}function Et(r,i,a,u,v,h){let y=new DataView(h.buffer),S=a[r.idx[0]].width,E=a[r.idx[0]].height,m=3,x=Math.floor(S/8),A=Math.ceil(S/8),C=Math.ceil(E/8),D=S-(A-1)*8,k=E-(C-1)*8,T={value:0},N=new Array(m),L=new Array(m),ae=new Array(m),ue=new Array(m),Te=new Array(m);for(let K=0;K<m;++K)Te[K]=i[r.idx[K]],N[K]=K<1?0:N[K-1]+A*C,L[K]=new Float32Array(64),ae[K]=new Uint16Array(64),ue[K]=new Uint16Array(A*64);for(let K=0;K<C;++K){let ve=8;K==C-1&&(ve=k);let Re=8;for(let ee=0;ee<A;++ee){ee==A-1&&(Re=D);for(let re=0;re<m;++re)ae[re].fill(0),ae[re][0]=v[N[re]++],It(T,u,ae[re]),Ut(ae[re],L[re]),At(L[re]);m==3&&Ct(L);for(let re=0;re<m;++re)zt(L[re],ue[re],ee*64)}let me=0;for(let ee=0;ee<m;++ee){let re=a[r.idx[ee]].type;for(let He=8*K;He<8*K+ve;++He){me=Te[ee][He];for(let yn=0;yn<x;++yn){let Be=yn*64+(He&7)*8;y.setUint16(me+0*2*re,ue[ee][Be+0],!0),y.setUint16(me+1*2*re,ue[ee][Be+1],!0),y.setUint16(me+2*2*re,ue[ee][Be+2],!0),y.setUint16(me+3*2*re,ue[ee][Be+3],!0),y.setUint16(me+4*2*re,ue[ee][Be+4],!0),y.setUint16(me+5*2*re,ue[ee][Be+5],!0),y.setUint16(me+6*2*re,ue[ee][Be+6],!0),y.setUint16(me+7*2*re,ue[ee][Be+7],!0),me+=8*2*re}}if(x!=A)for(let He=8*K;He<8*K+ve;++He){let yn=Te[ee][He]+8*x*2*re,Be=x*64+(He&7)*8;for(let On=0;On<Re;++On)y.setUint16(yn+On*2*re,ue[ee][Be+On],!0)}}}let ie=new Uint16Array(S);y=new DataView(h.buffer);for(let K=0;K<m;++K){a[r.idx[K]].decoded=!0;let ve=a[r.idx[K]].type;if(a[K].type==2)for(let Re=0;Re<E;++Re){let me=Te[K][Re];for(let ee=0;ee<S;++ee)ie[ee]=y.getUint16(me+ee*2*ve,!0);for(let ee=0;ee<S;++ee)y.setFloat32(me+ee*2*ve,U(ie[ee]),!0)}}}function It(r,i,a){let u,v=1;for(;v<64;)u=i[r.value],u==65280?v=64:u>>8==255?v+=u&255:(a[v]=u,v++),r.value++}function Ut(r,i){i[0]=U(r[0]),i[1]=U(r[1]),i[2]=U(r[5]),i[3]=U(r[6]),i[4]=U(r[14]),i[5]=U(r[15]),i[6]=U(r[27]),i[7]=U(r[28]),i[8]=U(r[2]),i[9]=U(r[4]),i[10]=U(r[7]),i[11]=U(r[13]),i[12]=U(r[16]),i[13]=U(r[26]),i[14]=U(r[29]),i[15]=U(r[42]),i[16]=U(r[3]),i[17]=U(r[8]),i[18]=U(r[12]),i[19]=U(r[17]),i[20]=U(r[25]),i[21]=U(r[30]),i[22]=U(r[41]),i[23]=U(r[43]),i[24]=U(r[9]),i[25]=U(r[11]),i[26]=U(r[18]),i[27]=U(r[24]),i[28]=U(r[31]),i[29]=U(r[40]),i[30]=U(r[44]),i[31]=U(r[53]),i[32]=U(r[10]),i[33]=U(r[19]),i[34]=U(r[23]),i[35]=U(r[32]),i[36]=U(r[39]),i[37]=U(r[45]),i[38]=U(r[52]),i[39]=U(r[54]),i[40]=U(r[20]),i[41]=U(r[22]),i[42]=U(r[33]),i[43]=U(r[38]),i[44]=U(r[46]),i[45]=U(r[51]),i[46]=U(r[55]),i[47]=U(r[60]),i[48]=U(r[21]),i[49]=U(r[34]),i[50]=U(r[37]),i[51]=U(r[47]),i[52]=U(r[50]),i[53]=U(r[56]),i[54]=U(r[59]),i[55]=U(r[61]),i[56]=U(r[35]),i[57]=U(r[36]),i[58]=U(r[48]),i[59]=U(r[49]),i[60]=U(r[57]),i[61]=U(r[58]),i[62]=U(r[62]),i[63]=U(r[63])}function At(r){let i=.5*Math.cos(.7853975),a=.5*Math.cos(3.14159/16),u=.5*Math.cos(3.14159/8),v=.5*Math.cos(3*3.14159/16),h=.5*Math.cos(5*3.14159/16),y=.5*Math.cos(3*3.14159/8),S=.5*Math.cos(7*3.14159/16),E=new Array(4),m=new Array(4),x=new Array(4),A=new Array(4);for(let C=0;C<8;++C){let D=C*8;E[0]=u*r[D+2],E[1]=y*r[D+2],E[2]=u*r[D+6],E[3]=y*r[D+6],m[0]=a*r[D+1]+v*r[D+3]+h*r[D+5]+S*r[D+7],m[1]=v*r[D+1]-S*r[D+3]-a*r[D+5]-h*r[D+7],m[2]=h*r[D+1]-a*r[D+3]+S*r[D+5]+v*r[D+7],m[3]=S*r[D+1]-h*r[D+3]+v*r[D+5]-a*r[D+7],x[0]=i*(r[D+0]+r[D+4]),x[3]=i*(r[D+0]-r[D+4]),x[1]=E[0]+E[3],x[2]=E[1]-E[2],A[0]=x[0]+x[1],A[1]=x[3]+x[2],A[2]=x[3]-x[2],A[3]=x[0]-x[1],r[D+0]=A[0]+m[0],r[D+1]=A[1]+m[1],r[D+2]=A[2]+m[2],r[D+3]=A[3]+m[3],r[D+4]=A[3]-m[3],r[D+5]=A[2]-m[2],r[D+6]=A[1]-m[1],r[D+7]=A[0]-m[0]}for(let C=0;C<8;++C)E[0]=u*r[16+C],E[1]=y*r[16+C],E[2]=u*r[48+C],E[3]=y*r[48+C],m[0]=a*r[8+C]+v*r[24+C]+h*r[40+C]+S*r[56+C],m[1]=v*r[8+C]-S*r[24+C]-a*r[40+C]-h*r[56+C],m[2]=h*r[8+C]-a*r[24+C]+S*r[40+C]+v*r[56+C],m[3]=S*r[8+C]-h*r[24+C]+v*r[40+C]-a*r[56+C],x[0]=i*(r[C]+r[32+C]),x[3]=i*(r[C]-r[32+C]),x[1]=E[0]+E[3],x[2]=E[1]-E[2],A[0]=x[0]+x[1],A[1]=x[3]+x[2],A[2]=x[3]-x[2],A[3]=x[0]-x[1],r[0+C]=A[0]+m[0],r[8+C]=A[1]+m[1],r[16+C]=A[2]+m[2],r[24+C]=A[3]+m[3],r[32+C]=A[3]-m[3],r[40+C]=A[2]-m[2],r[48+C]=A[1]-m[1],r[56+C]=A[0]-m[0]}function Ct(r){for(let i=0;i<64;++i){let a=r[0][i],u=r[1][i],v=r[2][i];r[0][i]=a+1.5747*v,r[1][i]=a-.1873*u-.4682*v,r[2][i]=a+1.8556*u}}function zt(r,i,a){for(let u=0;u<64;++u)i[a+u]=Zn.toHalfFloat(Tt(r[u]))}function Tt(r){return r<=1?Math.sign(r)*Math.pow(Math.abs(r),2.2):Math.sign(r)*Math.pow(se,Math.abs(r)-1)}function Ur(r){return new DataView(r.array.buffer,r.offset.value,r.size)}function Nt(r){let i=r.viewer.buffer.slice(r.offset.value,r.offset.value+r.size),a=new Uint8Array(Ir(i)),u=new Uint8Array(a.length);return Er(a),Qe(a,u),new DataView(u.buffer)}function Wn(r){let i=r.array.slice(r.offset.value,r.offset.value+r.size);typeof Xn>"u"&&console.error("THREE.EXRLoader: External library fflate.min.js required.");let a=Ye(i),u=new Uint8Array(a.length);return Er(a),Qe(a,u),new DataView(u.buffer)}function Ft(r){let i=r.viewer,a={value:r.offset.value},u=new Uint16Array(r.width*r.scanlineBlockSize*(r.channels*r.type)),v=new Uint8Array(8192),h=0,y=new Array(r.channels);for(let k=0;k<r.channels;k++)y[k]={},y[k].start=h,y[k].end=y[k].start,y[k].nx=r.width,y[k].ny=r.lines,y[k].size=r.type,h+=y[k].nx*y[k].ny*y[k].size;let S=wn(i,a),E=wn(i,a);if(E>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(S<=E)for(let k=0;k<E-S+1;k++)v[k+S]=Ve(i,a);let m=new Uint16Array(65536),x=V(v,m),A=Ae(i,a);pn(r.array,i,a,A,u,h);for(let k=0;k<r.channels;++k){let T=y[k];for(let N=0;N<y[k].size;++N)Yn(u,T.start+N,T.nx,T.size,T.ny,T.nx*T.size,x)}Fn(m,u,h);let C=0,D=new Uint8Array(u.buffer.byteLength);for(let k=0;k<r.lines;k++)for(let T=0;T<r.channels;T++){let N=y[T],L=N.nx*N.size,ae=new Uint8Array(u.buffer,N.end*2,L*2);D.set(ae,C),C+=L*2,N.end+=L}return new DataView(D.buffer)}function Rt(r){let i=r.array.slice(r.offset.value,r.offset.value+r.size);typeof Xn>"u"&&console.error("THREE.EXRLoader: External library fflate.min.js required.");let a=Ye(i),u=r.lines*r.channels*r.width,v=r.type==1?new Uint16Array(u):new Uint32Array(u),h=0,y=0,S=new Array(4);for(let E=0;E<r.lines;E++)for(let m=0;m<r.channels;m++){let x=0;switch(r.type){case 1:S[0]=h,S[1]=S[0]+r.width,h=S[1]+r.width;for(let A=0;A<r.width;++A)x+=a[S[0]++]<<8|a[S[1]++],v[y]=x,y++;break;case 2:S[0]=h,S[1]=S[0]+r.width,S[2]=S[1]+r.width,h=S[2]+r.width;for(let A=0;A<r.width;++A)x+=a[S[0]++]<<24|a[S[1]++]<<16|a[S[2]++]<<8,v[y]=x,y++;break}}return new DataView(v.buffer)}function Ar(r){let i=r.viewer,a={value:r.offset.value},u=new Uint8Array(r.width*r.lines*(r.channels*r.type*2)),v={version:Fe(i,a),unknownUncompressedSize:Fe(i,a),unknownCompressedSize:Fe(i,a),acCompressedSize:Fe(i,a),dcCompressedSize:Fe(i,a),rleCompressedSize:Fe(i,a),rleUncompressedSize:Fe(i,a),rleRawSize:Fe(i,a),totalAcUncompressedCount:Fe(i,a),totalDcUncompressedCount:Fe(i,a),acCompression:Fe(i,a)};if(v.version<2)throw new Error("EXRLoader.parse: "+mn.compression+" version "+v.version+" is unsupported");let h=new Array,y=wn(i,a)-2;for(;y>0;){let T=Rn(i.buffer,a),N=Ve(i,a),L=N>>2&3,ae=(N>>4)-1,ue=new Int8Array([ae])[0],Te=Ve(i,a);h.push({name:T,index:ue,type:Te,compression:L}),y-=T.length+3}let S=mn.channels,E=new Array(r.channels);for(let T=0;T<r.channels;++T){let N=E[T]={},L=S[T];N.name=L.name,N.compression=0,N.decoded=!1,N.type=L.pixelType,N.pLinear=L.pLinear,N.width=r.width,N.height=r.lines}let m={idx:new Array(3)};for(let T=0;T<r.channels;++T){let N=E[T];for(let L=0;L<h.length;++L){let ae=h[L];N.name==ae.name&&(N.compression=ae.compression,ae.index>=0&&(m.idx[ae.index]=T),N.offset=T)}}let x,A,C;if(v.acCompressedSize>0)switch(v.acCompression){case 0:x=new Uint16Array(v.totalAcUncompressedCount),pn(r.array,i,a,v.acCompressedSize,x,v.totalAcUncompressedCount);break;case 1:let T=r.array.slice(a.value,a.value+v.totalAcUncompressedCount),N=Ye(T);x=new Uint16Array(N.buffer),a.value+=v.totalAcUncompressedCount;break}if(v.dcCompressedSize>0){let T={array:r.array,offset:a,size:v.dcCompressedSize};A=new Uint16Array(Wn(T).buffer),a.value+=v.dcCompressedSize}if(v.rleRawSize>0){let T=r.array.slice(a.value,a.value+v.rleCompressedSize),N=Ye(T);C=Ir(N.buffer),a.value+=v.rleCompressedSize}let D=0,k=new Array(E.length);for(let T=0;T<k.length;++T)k[T]=new Array;for(let T=0;T<r.lines;++T)for(let N=0;N<E.length;++N)k[N].push(D),D+=E[N].width*r.type*2;Et(m,k,E,x,A,u);for(let T=0;T<E.length;++T){let N=E[T];if(!N.decoded)switch(N.compression){case 2:let L=0,ae=0;for(let ue=0;ue<r.lines;++ue){let Te=k[T][L];for(let ie=0;ie<N.width;++ie){for(let K=0;K<2*N.type;++K)u[Te++]=C[ae+K*N.width*N.height];ae++}L++}break;case 1:default:throw new Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(u.buffer)}function Rn(r,i){let a=new Uint8Array(r),u=0;for(;a[i.value+u]!=0;)u+=1;let v=new TextDecoder().decode(a.slice(i.value,i.value+u));return i.value=i.value+u+1,v}function Mt(r,i,a){let u=new TextDecoder().decode(new Uint8Array(r).slice(i.value,i.value+a));return i.value=i.value+a,u}function Ot(r,i){let a=vn(r,i),u=Ae(r,i);return[a,u]}function Dt(r,i){let a=Ae(r,i),u=Ae(r,i);return[a,u]}function vn(r,i){let a=r.getInt32(i.value,!0);return i.value=i.value+4,a}function Ae(r,i){let a=r.getUint32(i.value,!0);return i.value=i.value+4,a}function Cr(r,i){let a=r[i.value];return i.value=i.value+1,a}function Ve(r,i){let a=r.getUint8(i.value);return i.value=i.value+1,a}let Fe=function(r,i){let a;return"getBigInt64"in DataView.prototype?a=Number(r.getBigInt64(i.value,!0)):a=r.getUint32(i.value+4,!0)+Number(r.getUint32(i.value,!0)<<32),i.value+=8,a};function Se(r,i){let a=r.getFloat32(i.value,!0);return i.value+=4,a}function Zt(r,i){return Zn.toHalfFloat(Se(r,i))}function U(r){let i=(r&31744)>>10,a=r&1023;return(r>>15?-1:1)*(i?i===31?a?NaN:1/0:Math.pow(2,i-15)*(1+a/1024):6103515625e-14*(a/1024))}function wn(r,i){let a=r.getUint16(i.value,!0);return i.value+=2,a}function _t(r,i){return U(wn(r,i))}function kt(r,i,a,u){let v=a.value,h=[];for(;a.value<v+u-1;){let y=Rn(i,a),S=vn(r,a),E=Ve(r,a);a.value+=3;let m=vn(r,a),x=vn(r,a);h.push({name:y,pixelType:S,pLinear:E,xSampling:m,ySampling:x})}return a.value+=1,h}function Bt(r,i){let a=Se(r,i),u=Se(r,i),v=Se(r,i),h=Se(r,i),y=Se(r,i),S=Se(r,i),E=Se(r,i),m=Se(r,i);return{redX:a,redY:u,greenX:v,greenY:h,blueX:y,blueY:S,whiteX:E,whiteY:m}}function dt(r,i){let a=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],u=Ve(r,i);return a[u]}function Lt(r,i){let a=Ae(r,i),u=Ae(r,i),v=Ae(r,i),h=Ae(r,i);return{xMin:a,yMin:u,xMax:v,yMax:h}}function Ht(r,i){let a=["INCREASING_Y"],u=Ve(r,i);return a[u]}function Pt(r,i){let a=Se(r,i),u=Se(r,i);return[a,u]}function bt(r,i){let a=Se(r,i),u=Se(r,i),v=Se(r,i);return[a,u,v]}function Gt(r,i,a,u,v){if(u==="string"||u==="stringvector"||u==="iccProfile")return Mt(i,a,v);if(u==="chlist")return kt(r,i,a,v);if(u==="chromaticities")return Bt(r,a);if(u==="compression")return dt(r,a);if(u==="box2i")return Lt(r,a);if(u==="lineOrder")return Ht(r,a);if(u==="float")return Se(r,a);if(u==="v2f")return Pt(r,a);if(u==="v3f")return bt(r,a);if(u==="int")return vn(r,a);if(u==="rational")return Ot(r,a);if(u==="timecode")return Dt(r,a);if(u==="preview")return a.value+=v,"skipped";a.value+=v}function Xt(r,i,a){let u={};if(r.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");u.version=r.getUint8(4);let v=r.getUint8(5);u.spec={singleTile:!!(v&2),longName:!!(v&4),deepFormat:!!(v&8),multiPart:!!(v&16)},a.value=8;let h=!0;for(;h;){let y=Rn(i,a);if(y==0)h=!1;else{let S=Rn(i,a),E=Ae(r,a),m=Gt(r,i,a,S,E);m===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${S}'.`):u[y]=m}}if(v!=0)throw console.error("EXRHeader:",u),new Error("THREE.EXRLoader: provided file is currently unsupported.");return u}function Yt(r,i,a,u,v){let h={size:0,viewer:i,array:a,offset:u,width:r.dataWindow.xMax-r.dataWindow.xMin+1,height:r.dataWindow.yMax-r.dataWindow.yMin+1,channels:r.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:r.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(r.compression){case"NO_COMPRESSION":h.lines=1,h.uncompress=Ur;break;case"RLE_COMPRESSION":h.lines=1,h.uncompress=Nt;break;case"ZIPS_COMPRESSION":h.lines=1,h.uncompress=Wn;break;case"ZIP_COMPRESSION":h.lines=16,h.uncompress=Wn;break;case"PIZ_COMPRESSION":h.lines=32,h.uncompress=Ft;break;case"PXR24_COMPRESSION":h.lines=16,h.uncompress=Rt;break;case"DWAA_COMPRESSION":h.lines=32,h.uncompress=Ar;break;case"DWAB_COMPRESSION":h.lines=256,h.uncompress=Ar;break;default:throw new Error("EXRLoader.parse: "+r.compression+" is unsupported")}if(h.scanlineBlockSize=h.lines,h.type==1)switch(v){case Dn:h.getter=_t,h.inputSize=2;break;case xn:h.getter=wn,h.inputSize=2;break}else if(h.type==2)switch(v){case Dn:h.getter=Se,h.inputSize=4;break;case xn:h.getter=Zt,h.inputSize=4}else throw new Error("EXRLoader.parse: unsupported pixelType "+h.type+" for "+r.compression+".");h.blockCount=(r.dataWindow.yMax+1)/h.scanlineBlockSize;for(let S=0;S<h.blockCount;S++)Fe(i,u);h.outputChannels=h.channels==3?4:h.channels;let y=h.width*h.height*h.outputChannels;switch(v){case Dn:h.byteArray=new Float32Array(y),h.channels<h.outputChannels&&h.byteArray.fill(1,0,y);break;case xn:h.byteArray=new Uint16Array(y),h.channels<h.outputChannels&&h.byteArray.fill(15360,0,y);break;default:console.error("THREE.EXRLoader: unsupported type: ",v);break}return h.bytesPerLine=h.width*h.inputSize*h.channels,h.outputChannels==4?(h.format=Nr,h.encoding=qn):(h.format=Fr,h.encoding=qn),h}let Mn=new DataView(e),Wt=new Uint8Array(e),gn={value:0},mn=Xt(Mn,e,gn),P=Yt(mn,Mn,Wt,gn,this.type),zr={value:0},Kt={R:0,G:1,B:2,A:3,Y:0};for(let r=0;r<P.height/P.scanlineBlockSize;r++){let i=Ae(Mn,gn);P.size=Ae(Mn,gn),P.lines=i+P.scanlineBlockSize>P.height?P.height-i:P.scanlineBlockSize;let u=P.size<P.lines*P.bytesPerLine?P.uncompress(P):Ur(P);gn.value+=P.size;for(let v=0;v<P.scanlineBlockSize;v++){let h=v+r*P.scanlineBlockSize;if(h>=P.height)break;for(let y=0;y<P.channels;y++){let S=Kt[mn.channels[y].name];for(let E=0;E<P.width;E++){zr.value=(v*(P.channels*P.width)+y*P.width+E)*P.inputSize;let m=(P.height-1-h)*(P.width*P.outputChannels)+E*P.outputChannels+S;P.byteArray[m]=P.getter(u,zr)}}}}return{header:mn,width:P.width,height:P.height,data:P.byteArray,format:P.format,encoding:P.encoding,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,o,s){function f(l,p){l.encoding=p.encoding,l.minFilter=$e,l.magFilter=$e,l.generateMipmaps=!1,l.flipY=!1,t&&t(l,p)}return super.load(e,f,o,s)}};var gi={moduleName:Dr.EXRLoader,module:Sr};export{gi as EXRLoaderModule};
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/
